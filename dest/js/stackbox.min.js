!function(t,i){if("function"==typeof define&&define.amd)define(["module"],i);else if("undefined"!=typeof exports)i(module);else{var e={exports:{}};i(e),t.stackbox=e.exports}}(this,function(t){"use strict";var i=function(){function s(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,i,e){return i&&s(t.prototype,i),e&&s(t,e),t}}(),e=function(){function e(t){var i=this;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,e),this.args=void 0!==t?t:{},this.elm=void 0!==this.args.elm?this.args.elm:document.querySelector(".stackbox"),this.baseWidth=void 0!==this.args.baseWidth?this.args.baseWidth:1920,this.itemWidth=void 0!==this.args.itemWidth?this.args.itemWidth:200,this.itemHeight=void 0!==this.args.itemHeight?this.args.itemHeight:200,this.onLoad=void 0!==this.args.onLoad?this.args.onLoad:null,this.items=null!==this.elm?[].slice.call(this.elm.children):"",this.singleGridItem=document.querySelector('[data-grid="1,1"]'),this.verticalGridCnt=0,this.itemsData=[],this.liquid=void 0!==this.args.liquid?this.args.liquid:{},this.liquid.maxWidth=void 0!==this.args.liquid.maxWidth?this.args.liquid.maxWidth:0,this.liquid.cols=void 0!==this.args.liquid.maxWidth?this.args.liquid.cols:0,this.colsOrg=void 0!==this.args.cols?this.args.cols:1,this.cols=window.innerWidth>this.liquid.maxWidth?this.colsOrg:this.liquid.cols,this.rows=this.items.length/this.cols,this.eventHolder=function(){i.InitPos()},this.StackBox()}return i(e,[{key:"StackBox",value:function(){var i=this;if(""!==this.items){for(var t in this.items)this.itemsData.push(this.SetData(this.items[t]));this.InitPos().then(function(t){i.onLoad(t)}),this.itemsData[0].obj.addEventListener("transitionend",function(t){"height"===t.propertyName&&i.InitPos()}),this.SetWindowEvent()}}},{key:"SetWindowEvent",value:function(){window.addEventListener("resize",this.eventHolder)}},{key:"DestroyWindowEvent",value:function(){window.removeEventListener("resize",this.eventHolder)}},{key:"InitPos",value:function(){for(var t in 0!==this.liquid.maxWidth&&(this.cols=window.innerWidth>this.liquid.maxWidth?this.colsOrg:this.liquid.cols),this.rows=Math.floor(this.itemsData.length/this.cols),this.itemsData)this.itemsData[t]=this.SetData(this.itemsData[t].obj);return this.matrix=[],this.verticalGridCnt=0,this.matrix=this.GenerateMatrix(),this.SetToMatrix(this.itemsData),this.singleGrid=this.items.filter(function(t,i){return 0<=t.dataset.grid.indexOf("1,1")}),this.singleGridHeight=this.singleGrid[0].getBoundingClientRect().height,this.elm.style.height=this.singleGridHeight*(this.verticalGridCnt+1)+"px",Promise.resolve(this.elm)}},{key:"SetData",value:function(t){var i=t.getBoundingClientRect(),e=t.dataset.grid.split(",");return 1===Number(e[0])&&(this.allHeight=i.height),{obj:t,width:100/this.cols,height:i.height,row:Number(e[0]),col:Number(e[1])}}},{key:"GenerateMatrix",value:function(){for(var t=[],i=0;i<this.rows+10;){var e=0;for(t[i]=[];e<this.cols;)t[i][e]=0,e++;i++}return t}},{key:"SetToMatrix",value:function(t){for(var i=!1,e=0,s=0;s<this.matrix.length;){for(var h=0;h<this.cols;){if(void 0===t[e])return;if(0===this.matrix[s][h]){var o=this.matrix[s][h+t[e].col-1];if(void 0===o||1===o){i=!0;break}t[e].obj.style.width=t[e].width*t[e].col+"%";var r=Math.round(this.singleGridItem.getBoundingClientRect().width/this.itemWidth*100)/100,n=Math.round(this.itemHeight*r);t[e].obj.style.height=Math.round(n*t[e].row)+"px",t[e].obj.style.position="absolute",t[e].obj.style.top=Math.round(s*n)+"px",t[e].obj.style.left=h*t[e].width+"%";for(var a=0;a<t[e].row;){for(var d=0;d<t[e].col;)this.matrix[s+a][h+d]=1,this.verticalGridCnt<s+a&&(this.verticalGridCnt=s+a),d++;a++}i&&(s=h=0,i=!1),e++}h++}s++}}}]),e}();t.exports=e,"undefined"!=typeof window&&!window.StackBox&&(window.StackBox=e)});