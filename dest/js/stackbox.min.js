!function(i,t){if("function"==typeof define&&define.amd)define(["module"],t);else if("undefined"!=typeof exports)t(module);else{var e={exports:{}};t(e),i.stackbox=e.exports}}(this,function(i){"use strict";var t=function(){function s(i,t){for(var e=0;e<t.length;e++){var s=t[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}return function(i,t,e){return t&&s(i.prototype,t),e&&s(i,e),i}}(),e=function(){function e(i){var t=this;!function(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.args=void 0!==i?i:{},this.elm=void 0!==this.args.elm?this.args.elm:document.querySelector(".stackbox"),this.baseWidth=void 0!==this.args.baseWidth?this.args.baseWidth:1920,this.itemWidth=void 0!==this.args.itemWidth?this.args.itemWidth:200,this.itemHeight=void 0!==this.args.itemHeight?this.args.itemHeight:200,this.onLoad=void 0!==this.args.onLoad?this.args.onLoad:null,this.items=null!==this.elm?[].slice.call(this.elm.children):"",this.singleGridItem=document.querySelector('[data-grid="1,1"]'),this.verticalGridCnt=0,this.itemsData=[],console.log({item:this.singleGridItem,height:this.singleGridItem.offsetWidth}),this.liquid=void 0!==this.args.liquid?this.args.liquid:{},this.liquid.maxWidth=void 0!==this.args.liquid.maxWidth?this.args.liquid.maxWidth:0,this.liquid.cols=void 0!==this.args.liquid.maxWidth?this.args.liquid.cols:0,this.colsOrg=void 0!==this.args.cols?this.args.cols:1,this.cols=window.innerWidth>this.liquid.maxWidth?this.colsOrg:this.liquid.cols,this.rows=this.items.length/this.cols,this.eventHolder=function(){t.InitPos()},this.StackBox()}return t(e,[{key:"StackBox",value:function(){var t=this;if(""!==this.items){for(var i in this.items)this.itemsData.push(this.SetData(this.items[i]));this.singleGrid=this.items.filter(function(i,t){return 0<=i.dataset.grid.indexOf("1,1")}),this.itemsData.unshift(this.SetData(this.singleGrid[0])),this.InitPos().then(function(i){t.onLoad(i)}),this.itemsData[0].obj.addEventListener("transitionend",function(i){"height"===i.propertyName&&t.InitPos()}),this.SetWindowEvent()}}},{key:"SetWindowEvent",value:function(){window.addEventListener("resize",this.eventHolder)}},{key:"DestroyWindowEvent",value:function(){window.removeEventListener("resize",this.eventHolder)}},{key:"InitPos",value:function(){var e=this;return new Promise(function(i){for(var t in 0!==e.liquid.maxWidth&&(e.cols=window.innerWidth>e.liquid.maxWidth?e.colsOrg:e.liquid.cols),e.rows=Math.floor(e.itemsData.length/e.cols),e.itemsData)e.itemsData[t]=e.SetData(e.itemsData[t].obj);return e.matrix=[],e.verticalGridCnt=0,e.matrix=e.GenerateMatrix(),e.SetToMatrix(e.itemsData),e.singleGrid=e.items.filter(function(i,t){return 0<=i.dataset.grid.indexOf("1,1")}),e.singleGridHeight=e.singleGrid[0].getBoundingClientRect().height,e.elm.style.height=e.singleGridHeight*(e.verticalGridCnt+1)+"px",i(e.elm)})}},{key:"SetData",value:function(i){var t=i.getBoundingClientRect(),e=i.dataset.grid.split(",");return 1===Number(e[0])&&(this.allHeight=t.height),{obj:i,width:100/this.cols,row:Number(e[0]),col:Number(e[1])}}},{key:"GenerateMatrix",value:function(){for(var i=[],t=0;t<this.rows+10;){var e=0;for(i[t]=[];e<this.cols;)i[t][e]=0,e++;t++}return i}},{key:"SetToMatrix",value:function(i){for(var t=!1,e=!0,s=0,n=0;n<this.matrix.length;){for(var r=0;r<this.cols;){if(void 0===i[s])return;if(0===this.matrix[n][r]){var o=this.matrix[n][r+i[s].col-1];if(void 0===o||1===o){t=!0;break}i[s].obj.style.width=i[s].width*i[s].col+"%";var a=Math.round(this.singleGridItem.getBoundingClientRect().width/this.itemWidth*100)/100,h=Math.round(this.itemHeight*a);if(i[s].obj.style.height=Math.round(h*i[s].row)+"px",e){e=!1,s++;continue}i[s].obj.style.position="absolute",i[s].obj.style.top=Math.round(n*h)+"px",i[s].obj.style.left=r*i[s].width+"%";for(var d=0;d<i[s].row;){for(var l=0;l<i[s].col;)this.matrix[n+d][r+l]=1,this.verticalGridCnt<n+d&&(this.verticalGridCnt=n+d),l++;d++}t&&(n=r=0,t=!1),s++}r++}n++}}}]),e}();i.exports=e,"undefined"!=typeof window&&!window.StackBox&&(window.StackBox=e)});